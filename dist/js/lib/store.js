/* Copyright (c) 2010-2012 Marcus Westin */

(function(){function e(){try{return i in n&&n[i]}catch(e){return!1}}var t={},n=window,r=n.document,i="localStorage",s="__storejs__",o;t.disabled=!1,t.set=function(e,t){},t.get=function(e){},t.remove=function(e){},t.clear=function(){},t.transact=function(e,n,r){var i=t.get(e);r==null&&(r=n,n=null),typeof i=="undefined"&&(i=n||{}),r(i),t.set(e,i)},t.getAll=function(){},t.serialize=function(e){return JSON.stringify(e)},t.deserialize=function(e){if(typeof e!="string")return undefined;try{return JSON.parse(e)}catch(t){return e||undefined}};if(e())o=n[i],t.set=function(e,n){return n===undefined?t.remove(e):(o.setItem(e,t.serialize(n)),n)},t.get=function(e){return t.deserialize(o.getItem(e))},t.remove=function(e){o.removeItem(e)},t.clear=function(){o.clear()},t.getAll=function(){var e={};for(var n=0;n<o.length;++n){var r=o.key(n);e[r]=t.get(r)}return e};else if(r.documentElement.addBehavior){var u,a;try{a=new ActiveXObject("htmlfile"),a.open(),a.write('<script>document.w=window</script><iframe src="/favicon.ico"></frame>'),a.close(),u=a.w.frames[0].document,o=u.createElement("div")}catch(f){o=r.createElement("div"),u=r.body}function l(e){return function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(o),u.appendChild(o),o.addBehavior("#default#userData"),o.load(i);var r=e.apply(t,n);return u.removeChild(o),r}}var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function h(e){return e.replace(c,"___")}t.set=l(function(e,n,r){return n=h(n),r===undefined?t.remove(n):(e.setAttribute(n,t.serialize(r)),e.save(i),r)}),t.get=l(function(e,n){return n=h(n),t.deserialize(e.getAttribute(n))}),t.remove=l(function(e,t){t=h(t),e.removeAttribute(t),e.save(i)}),t.clear=l(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(i);for(var n=0,r;r=t[n];n++)e.removeAttribute(r.name);e.save(i)}),t.getAll=l(function(e){var n=e.XMLDocument.documentElement.attributes,r={};for(var i=0,s;s=n[i];++i){var o=h(s.name);r[s.name]=t.deserialize(e.getAttribute(o))}return r})}try{t.set(s,s),t.get(s)!=s&&(t.disabled=!0),t.remove(s)}catch(f){t.disabled=!0}t.enabled=!t.disabled,typeof module!="undefined"&&typeof module!="function"?module.exports=t:typeof define=="function"&&define.amd?define(t):this.store=t})();